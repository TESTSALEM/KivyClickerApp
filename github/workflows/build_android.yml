name: Kivy Android Build

on:
  # ØªØ´ØºÙŠÙ„ Ø³ÙŠØ± Ø§Ù„Ø¹Ù…Ù„ Ø¹Ù†Ø¯ Ø±ÙØ¹ (push) Ø£ÙŠ ØªØºÙŠÙŠØ±Ø§Øª Ø¥Ù„Ù‰ ÙØ±Ø¹ main
  push:
    branches: [ "main" ]
  # ØªØ´ØºÙŠÙ„ Ø³ÙŠØ± Ø§Ù„Ø¹Ù…Ù„ Ø¹Ù†Ø¯ Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø³Ø­Ø¨ (Pull Request)
  pull_request:
    branches: [ "main" ]

jobs:
  build:
    # Ø³ÙŠØªÙ… ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¨Ù†Ø§Ø¡ Ø¹Ù„Ù‰ Ø¨ÙŠØ¦Ø© Linux (Ubuntu)
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout Code
      uses: actions/checkout@v4

    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        # Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø¥ØµØ¯Ø§Ø± Python 3.10
        python-version: '3.10'

    - name: Install Buildozer and Cython ğŸ› ï¸
      run: |
        # ØªØ«Ø¨ÙŠØª Buildozer
        pip install buildozer 
        # ØªØ«Ø¨ÙŠØª Cython Ù„Ø­Ù„ Ø®Ø·Ø£ "Cython not found"
        pip install cython 

    - name: Build Kivy App (This takes time)
      # ØªØ´ØºÙŠÙ„ Ø£Ù…Ø± Ø§Ù„Ø¨Ù†Ø§Ø¡ Ø§Ù„ÙØ¹Ù„ÙŠ
      run: |
        buildozer android debug

    - name: Upload APK Artifact
      uses: actions/upload-artifact@v4
      with:
        # Ø§Ø³Ù… Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø°ÙŠ Ø³ÙŠØªÙ… Ø­ÙØ¸Ù‡ Ø¹Ù„Ù‰ GitHub
        name: Android-APK-Release
        # Ù…Ø³Ø§Ø± Ù…Ù„Ù APK Ø§Ù„Ù†Ø§ØªØ¬
        path: bin/*.apk
